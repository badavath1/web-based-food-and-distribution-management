<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Food Donation Logistics Control</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Inter,sans-serif;}

body{
    background:#0d1117;
    color:white;
}

.header{
    background:#161b22;
    padding:15px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.header h2{color:#58a6ff;font-size:18px;}

.badge{
    background:#238636;
    padding:6px 12px;
    border-radius:20px;
    font-size:12px;
}

.container{
    display:grid;
    grid-template-columns:1fr 2fr;
    gap:20px;
    padding:20px;
}

.card{
    background:#161b22;
    padding:20px;
    border-radius:15px;
    box-shadow:0 10px 30px rgba(0,0,0,0.4);
}

input,select{
    width:100%;
    padding:10px;
    margin-bottom:12px;
    border-radius:8px;
    border:1px solid #30363d;
    background:#0d1117;
    color:white;
}

button{
    width:100%;
    padding:10px;
    border:none;
    border-radius:8px;
    background:#58a6ff;
    color:white;
    font-weight:600;
    cursor:pointer;
    margin-bottom:10px;
}

button:hover{background:#1f6feb;}

.status-box{
    margin-top:10px;
    padding:10px;
    background:#0d1117;
    border-radius:10px;
}

#map{
    height:70vh;
    width:100%;
    border-radius:15px;
}

@media(max-width:900px){
    .container{
        grid-template-columns:1fr;
    }
}
</style>
</head>

<body>

<div class="header">
<h2>ðŸšš Food Donation Logistics</h2>
<div class="badge">Volunteer Delivery System</div>
</div>

<div class="container">

<!-- LEFT PANEL -->
<div class="card">

<h3>Assign Volunteer</h3>

<input type="text" id="donorName" placeholder="Donor Name">
<input type="text" id="volunteerName" placeholder="Volunteer Name">

<select id="priority">
<option>Normal Priority</option>
<option>High Priority</option>
<option>Emergency</option>
</select>

<button onclick="assignVolunteer()">Assign Volunteer</button>
<button onclick="updateStatus('Picked Up')">Mark Picked Up</button>
<button onclick="updateStatus('In Transit')">Start Delivery</button>
<button onclick="updateStatus('Delivered')">Mark Delivered</button>

<div class="status-box">
<p><strong>Status:</strong> <span id="status">Waiting Assignment</span></p>
<p><strong>Distance:</strong> <span id="distance">-- km</span></p>
<p><strong>ETA:</strong> <span id="eta">-- min</span></p>
</div>

</div>

<!-- RIGHT PANEL -->
<div class="card">
<h3>Live Volunteer Tracking</h3>
<div id="map"></div>
</div>

</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>

let map = L.map('map').setView([20.5937,78.9629],5);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
    attribution:'Â© OpenStreetMap'
}).addTo(map);

let donorLocation;
let volunteerMarker;
let routeLine;
let totalDistance = 0;
let step = 0;

navigator.geolocation.getCurrentPosition(function(position){

    let lat = position.coords.latitude;
    let lng = position.coords.longitude;

    donorLocation = [lat,lng];

    map.setView(donorLocation,14);

    L.marker(donorLocation).addTo(map)
        .bindPopup("ðŸ“ Donor Location")
        .openPopup();

    volunteerMarker = L.marker(donorLocation).addTo(map)
        .bindPopup("ðŸš¶ Volunteer");

    routeLine = L.polyline([donorLocation],{color:'#58a6ff'}).addTo(map);

});

function assignVolunteer(){

    let donor = document.getElementById("donorName").value;
    let volunteer = document.getElementById("volunteerName").value;

    if(!donor || !volunteer){
        alert("Enter Donor and Volunteer Name");
        return;
    }

    document.getElementById("status").innerText =
        "Volunteer Assigned to "+donor;

}

function updateStatus(newStatus){

    document.getElementById("status").innerText = newStatus;

    if(newStatus === "In Transit"){
        startDelivery();
    }

}

function startDelivery(){

    let interval = setInterval(()=>{

        let current = volunteerMarker.getLatLng();

        let newLat = current.lat + 0.001;
        let newLng = current.lng + 0.001;

        let newPosition = [newLat,newLng];

        volunteerMarker.setLatLng(newPosition);
        routeLine.addLatLng(newPosition);

        totalDistance += 0.12;

        document.getElementById("distance").innerText =
            totalDistance.toFixed(2)+" km";

        document.getElementById("eta").innerText =
            Math.max(0,15-step)+" min";

        step++;

        if(step >= 15){
            clearInterval(interval);
            document.getElementById("status").innerText = "Delivered âœ…";
            document.getElementById("eta").innerText = "0 min";
        }

    },2000);

}

</script>

</body>
</html>